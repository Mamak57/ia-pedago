<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Comprendre lâ€™IA (sans prise de tÃªte)</title>
  <style>
    body { background:#0b1020; color:#e8ecff; font-family:system-ui; margin:0; padding:20px; }
    .card { background:#111a33; border-radius:12px; padding:16px; max-width:700px; margin:0 auto; }
    textarea { width:100%; min-height:80px; margin-top:10px; border-radius:8px; padding:10px; }
    button { margin-top:10px; padding:10px 14px; border-radius:8px; cursor:pointer; }
    #answer { margin-top:12px; white-space:pre-wrap; background:#0f1730; padding:12px; border-radius:8px; }
  </style>
</head>
<body>

<div class="card">
  <h2>Pose une question Ã  lâ€™IA</h2>
  <textarea id="question" placeholder="Ex: De quelle couleur est la mer ?"></textarea>
  <button id="sendBtn" type="button">Envoyer</button>
  <div id="answer"></div>
</div>

<script>
const WEBHOOK_URL = "https://n8n.srv803340.hstgr.cloud/webhook/ia-pedagogique";
const API_KEY = "ia-pedago-9c3a4f2d8e17b6";

async function ask() {
  console.log("ask() appelÃ©e");

  const question = document.getElementById("question").value.trim();
  console.log("Question :", question);

  if (!question) {
    alert("Entre une question ðŸ™‚");
    return;
  }

  document.getElementById("answer").textContent = "Je rÃ©flÃ©chisâ€¦";

  try {
    const res = await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": API_KEY
      },
      body: JSON.stringify({ question })
    });

    console.log("Status fetch :", res.status);

    const data = await res.json();
    console.log("RÃ©ponse :", data);

    document.getElementById("answer").textContent = data.answer || JSON.stringify(data);

  } catch (err) {
    console.error("Erreur fetch :", err);
    document.getElementById("answer").textContent = "Erreur : " + err.message;
  }
}

document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("sendBtn");
  btn.addEventListener("click", ask);
});
</script>

</body>
</html>
